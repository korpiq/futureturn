<html>
<head>
 <style>
   div.hex {
     position: absolute;
     border: 1px solid black;
     background-color: white;
     height: 2em;
     width: 2em;
     text-align: center;
   }
   #hexmap_display {
       position: fixed;
       right: 0;
       width: 70%;
       height: 100%;
   }
 </style>
 <script type="text/javascript" language="javascript" src="HexTile.js"></script>
 <script type="text/javascript" language="javascript" src="HexMap.js"></script>
 <script type="text/javascript" language="javascript" src="HexTileBag.js"></script>
 <script language="javascript">
  var
    hexmap,
    tilebags,
    currentHexTileBag,
    hexesPerType
    ;

  function draw_by_form()
  {
    if(! hexmap)
        hexmap = new HexMap({
            displayContainer: document.getElementById("hexmap_display")
        });

    ns = parseInt(document.getElementById("ns").value);
    nwse = parseInt(document.getElementById("nwse").value);
    nesw = parseInt(document.getElementById("nesw").value);

    hexmap.setSizes(ns, nwse, nesw);
    hexmap.draw();

    report();
    createTileBags();
  }

  function createTileBags()
  {
      if(tilebags && tilebags.length > 0)
      {
          for(var i=0; i < tilebags.length; ++i)
          {
              document.body.removeChild(tilebags[i].element);
          }
      }
      tilebags = [];
      var count = parseInt(document.getElementById('types').value);

      for(var i=1; i <= count; ++i)
      {
          tilebags.push(new HexTileBag(i, count, hexesPerType));
      }
      currentHexTileBag = tilebags[Math.floor(count/2 - 0.5)];
      currentHexTileBag.element.click();
  }

  function report()
  {
    hexes = hexmap.hexes.length;
    num_players = parseInt(document.getElementById("players").value);
    num_types = parseInt(document.getElementById("types").value);

    setText("hexes", hexes);
    setText("hexes_per_player", Math.floor(hexes / num_players));
    setText("hexes_per_type", hexesPerType = Math.ceil(hexes / num_types));
  }

  function setText(id, content)
  {
      document.getElementById(id).textContent = content;
  }

  function setPlayers(value)
  {
      value = 3 + parseInt(value);
      document.getElementById("ns").value = value;
      setSides(value);
  }

  function setSides(value)
  {
      document.getElementById("nwse").value = value;
      document.getElementById("nesw").value = value;
      draw_by_form();
  }
 </script>
</head>
<body onload="draw_by_form()">

 <div id="hexmap_display">&nbsp;</div>

 <form id="hexmap_settings" onsubmit="draw_by_form(); return false;">
  tile types: <input id="types" value="6" onchange="draw_by_form()"><br/>
  players: <input id="players" value="3" onchange="setPlayers(this.value)"><br/>
  edge lengths:<br/>
  sides: <input id="ns" value="6" onchange="setSides(this.value)"><br/>
  nw+se: <input id="nwse" value="6" onchange="setSides(this.value)"><br/>
  ne+sw: <input id="nesw" value="6" onchange="draw_by_form()"><br/>
  hexes: <span id="hexes"></span><br/>
  per player: <span id="hexes_per_player"></span><br/>
  per type: <span id="hexes_per_type"></span><br/>
 </form>

</body>
</html>
